<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Contrast DevSec Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Contrast DevSec Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Contrast DevSec" href="/opensearch.xml"><title data-react-helmet="true">Capture the Flag, Solution Write-Up | Contrast DevSec</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://contrastsecurity.dev/blog/CTF Write-Up"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="Capture the Flag, Solution Write-Up | Contrast DevSec"><meta data-react-helmet="true" name="description" content="Contrast Labs is our security research team, writing the rules that power Contrast&#x27;s suite of tools. A lot of our research starts with vulnerability analysis, reading and understanding how different exploits work at an API level and how we can detect that: during code analysis with Contrast Scan or as the application runs with Contrast Assess."><meta data-react-helmet="true" property="og:description" content="Contrast Labs is our security research team, writing the rules that power Contrast&#x27;s suite of tools. A lot of our research starts with vulnerability analysis, reading and understanding how different exploits work at an API level and how we can detect that: during code analysis with Contrast Scan or as the application runs with Contrast Assess."><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2021-10-07T00:00:00.000Z"><meta data-react-helmet="true" property="article:tag" content="research"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://contrastsecurity.dev/blog/CTF Write-Up"><link data-react-helmet="true" rel="alternate" href="https://contrastsecurity.dev/blog/CTF Write-Up" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://contrastsecurity.dev/blog/CTF Write-Up" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D90D16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.edaee6cd.css">
<link rel="preload" href="/assets/js/runtime~main.0182176c.js" as="script">
<link rel="preload" href="/assets/js/main.42a8bce7.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_RReh"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/cs-devsec-1.png" alt="Dev Site Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/cs-devsec-1.png" alt="Dev Site Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title"></b></a><a class="navbar__item navbar__link" href="/docs/getting-started/where-do-i-start">Getting Started</a><a class="navbar__item navbar__link" href="/docs/learn-devsec/index">Learn DevSec</a><a class="navbar__item navbar__link" href="/events">Events</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">DevSec Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Contrast-Security-OSS" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_2i4l react-toggle--checked react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" checked="" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_Bc3W"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_q+wC thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_9G5K margin-bottom--md">Recent posts</div><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a aria-current="page" class="sidebarItemLink_zyXk sidebarItemLinkActive_wcJs" href="/blog/CTF Write-Up">Capture the Flag, Solution Write-Up</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/Bangladesh JUG">Securing and Exploiting Java Applications</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/Podcast - Jakarta EE">Journey to Jakarta Podcast</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_d4p0" itemprop="headline">Capture the Flag, Solution Write-Up</h1><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2021-10-07T00:00:00.000Z" itemprop="datePublished">October 7, 2021</time> Â· 5 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://github.com/clevernyyyy.png" alt="Adam Schaal"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a itemprop="url"><span itemprop="name">Adam Schaal</span></a></div><small class="avatar__subtitle" itemprop="description">Security Research</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Contrast Labs is our security research team, writing the rules that power Contrast&#x27;s suite of tools. A lot of our research starts with vulnerability analysis, reading and understanding how different exploits work at an API level and how we can detect that: during code analysis with Contrast Scan or as the application runs with Contrast Assess.</p><p>To fully understand these exploits, our team frequently participates in Capture the Flag competitions to learn new styles of attacking applications. While we place well in many of the competitions, the real benefit is the team working together to play a game and the ability for new team members early in their career to rapidly improve their skills while having fun. We hire across a range of skills, but a common characteristic of every team member is the ability to work well together and help each-other.</p><p>We recently participated in the Cybrics CTF and performed a write-up of how our team solved one of the challenges to find a vulnerability in a message commit system. Here is the solution to the &quot;Too Secure&quot; problem:</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3ly5" id="challenge-description"></a>Challenge Description<a class="hash-link" href="#challenge-description" title="Direct link to heading">#</a></h2><p>Find a vulnerability in our novel message commitment system. Read the paper here: <a href="https://cybrics.net/files/too_secure.pdf" target="_blank" rel="noopener noreferrer" download="./too_secure.pdf">too_secure.pdf</a></p><p>Enter decimal r2 value as the flag. Flag format here is NOT cybrics{...}</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3ly5" id="maths"></a>Maths<a class="hash-link" href="#maths" title="Direct link to heading">#</a></h3><br>Let H(x) be the function that generates Ã¢ given x<br>Let x<sub>1</sub>, x<sub>2</sub> be the integer representations of M<sub>1</sub> and M<sub>2</sub>, respectively.<br>We&#x27;re given<br>c = G * h <sup>r</sup><br>Where G = g<sup>x</sup> mod p and h = g ^ H(x) mod p<br>We can combine and simplify:<br>c = g<sup>x + H(x)*r</sup> mod p<br><br>To break the system, we want to find r<sub>2</sub> such that<br>c<sub>1</sub> = c<sub>2</sub> mod p<br>g<sup>x<sub>1</sub> + H(x<sub>1</sub>)*r<sub>1</sub></sup> = g<sup>x<sub>2</sub> + H(x<sub>2</sub>)*r<sub>2</sub></sup>mod p<br>Since g is known, and we&#x27;re given that the O<sub>p</sub>(g) = q, we could solve the above by solving:<br>x<sub>1</sub> + H(x<sub>1</sub>)*r<sub>1</sub> = x<sub>2</sub> + H(x<sub>2</sub>)*r<sub>2</sub> mod q<br>r2 = (x<sub>1</sub> - x<sub>2</sub> + H(x<sub>1</sub>)*r<sub>1</sub>) * H(x<sub>2</sub>)<sup>-1</sup> mod q<br>Where H(x<sub>2</sub>)<sup>-1</sup> is the multiplicative inverse of H(x<sub>2</sub>) modulo q ### Finding q<br>We were given q | (p-1), g<sup>q</sup> = 1 mod p. Luckily, factoring p-1 was pretty quick via some online factorization calculators<br>https://www.dcode.fr/prime-factors-decomposition<br>We test each prime factor against g and p.<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">g </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">10729072579307052184848302322451332192456229619044181105063011741516558110216720725</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">qs </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">2</span><span class="token plain">, </span><span class="token number">3</span><span class="token plain">, </span><span class="token number">7</span><span class="token plain">, </span><span class="token number">3671</span><span class="token plain">, </span><span class="token number">10733</span><span class="token plain">, </span><span class="token number">1039300813886545966418005631983853921163721828798787466771912919828750891</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">p </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">12039102490128509125925019010000012423515617235219127649182470182570195018265927223</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">q </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token for-or-select variable" style="color:rgb(189, 147, 249);font-style:italic">q_</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> qs:</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">v</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> pow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">g, q_, p</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">v</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain">:</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        q </span><span class="token operator">=</span><span class="token plain"> q_</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;q&quot;</span><span class="token plain">, q</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token plain"> q </span><span class="token number">1039300813886545966418005631983853921163721828798787466771912919828750891</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3ly5" id="finding-hx"></a>Finding H(x)<a class="hash-link" href="#finding-hx" title="Direct link to heading">#</a></h3><br>Computing H(x) (called HAT(x) in the code below) was a little convoluted given the instructions:<br>Note: since p is prime, totient(p) = p-1<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">def str2val</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">message</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">:</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  val </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  mult </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token for-or-select variable" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> message:</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    val </span><span class="token operator">+=</span><span class="token plain"> ord</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">let</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> * mult</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    mult *</span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">256</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">return</span><span class="token plain"> val</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">def chunkstring</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">string, length</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">:</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token plain">+i:length+i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token for-or-select variable" style="color:rgb(189, 147, 249);font-style:italic">i</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> range</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token plain">, len</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">, length</span><span class="token punctuation" style="color:rgb(248, 248, 242)">))</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">def bitstring_to_bytes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">:</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    b </span><span class="token operator">=</span><span class="token plain"> bytearray</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    chunks </span><span class="token operator">=</span><span class="token plain"> chunkstring</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">s, </span><span class="token number">8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token for-or-select variable" style="color:rgb(189, 147, 249);font-style:italic">chunk</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> chunks:</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        num </span><span class="token operator">=</span><span class="token plain"> int</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">chunk, </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        b.append</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">num </span><span class="token operator">&amp;</span><span class="token plain"> 0xff</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">return</span><span class="token plain"> bytes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">def HAT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">:</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  G </span><span class="token operator">=</span><span class="token plain"> pow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">g, x, p</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  numStr </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{0:b}&quot;</span><span class="token plain">.format</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">G</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> len</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">numStr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain"> </span><span class="token number">1024</span><span class="token plain">:</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      numStr </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0&quot;</span><span class="token plain"> * </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1024</span><span class="token plain"> - len</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">numStr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">))</span><span class="token plain"> + numStr</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Gp </span><span class="token operator">=</span><span class="token plain"> bitstring_to_bytes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">numStr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  a </span><span class="token operator">=</span><span class="token plain"> hashlib.sha512</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Gp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">.hexdigest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ap </span><span class="token operator">=</span><span class="token plain"> int</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">a, </span><span class="token number">16</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  app </span><span class="token operator">=</span><span class="token plain"> pow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ap, ap, p-1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">return</span><span class="token plain"> app</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">r1 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">31245182471</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">M1 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Hi! I am Vadim Davydov from ITMO University&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">x1 </span><span class="token operator">=</span><span class="token plain"> str2val</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">M1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">M2 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Transfer the points for easy task to this team&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">x2 </span><span class="token operator">=</span><span class="token plain"> str2val</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">M2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hat_x1 </span><span class="token operator">=</span><span class="token plain"> HAT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">x1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hat_x2 </span><span class="token operator">=</span><span class="token plain"> HAT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">x2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3ly5" id="finding-hx2-1"></a>Finding H(x<sub>2</sub>)<sup>-1</sup><a class="hash-link" href="#finding-hx2-1" title="Direct link to heading">#</a></h3><p>Since q is prime, H(x<sub>2</sub>) and q are coprime, so we can use the Extended Euclidean Algorithm to find H(x<sub>2</sub>)<sup>-1</sup>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">def modulo_multiplicative_inverse</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">A, M</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">:</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token plain">&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Assumes that A and M are co-prime</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Returns multiplicative modulo inverse of A under M</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token plain">&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Find gcd using Extended Euclid&#x27;s Algorithm</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    gcd, x, y </span><span class="token operator">=</span><span class="token plain"> extended_euclid_gcd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">A, M</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># In case x is negative, we handle it by adding extra M</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Because we know that multiplicative inverse of A in range M lies</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># in the range [0, M-1]</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> x </span><span class="token operator">&lt;</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain">:</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        x </span><span class="token operator">+=</span><span class="token plain"> M</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">return</span><span class="token plain"> x</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">def extended_euclid_gcd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">a, b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">:</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token plain">&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Returns a list </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">`</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">result</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">`</span><span class="token plain"> of size </span><span class="token number">3</span><span class="token plain"> where:</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Referring to the equation ax + by </span><span class="token operator">=</span><span class="token plain"> gcd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">a, b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        result</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> is gcd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">a, b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        result</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> is x</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        result</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> is y</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token plain">&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    s </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    old_s </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    t </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    old_t </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    r </span><span class="token operator">=</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    old_r </span><span class="token operator">=</span><span class="token plain"> a</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">while</span><span class="token plain"> r </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain">:</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        quotient </span><span class="token operator">=</span><span class="token plain"> old_r // r  </span><span class="token comment" style="color:rgb(98, 114, 164)"># In Python, // operator performs integer or floored division</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># This is a pythonic way to swap numbers</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># See the same part in C++ implementation below to know more</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        old_r, r </span><span class="token operator">=</span><span class="token plain"> r, old_r - quotient * r</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        old_s, s </span><span class="token operator">=</span><span class="token plain"> s, old_s - quotient * s</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        old_t, t </span><span class="token operator">=</span><span class="token plain"> t, old_t - quotient * t</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">old_r, old_s, old_t</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">inv </span><span class="token operator">=</span><span class="token plain"> modulo_multiplicative_inverse</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">hat_x2, q</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3ly5" id="putting-it-all-together"></a>Putting it all together<a class="hash-link" href="#putting-it-all-together" title="Direct link to heading">#</a></h3><br>r2 = (x<sub>1</sub> - x<sub>2</sub> + H(x<sub>1</sub>)*r<sub>1</sub>) * H(x<sub>2</sub>)<sup>-1</sup> mod q<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">print </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">((</span><span class="token plain">x1 - x2 + hat_x1 * r1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> * inv </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> % q </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token number">299610740605778098196154877327490870095375317123548563579894088319476495</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_xD8n"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/research">research</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/erikcostlow/contrast-dev-site/edit/main/website/blog/blog/2021-10-07.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/Bangladesh JUG"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Securing and Exploiting Java Applications Â»</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#challenge-description" class="table-of-contents__link">Challenge Description</a><ul><li><a href="#maths" class="table-of-contents__link">Maths</a></li><li><a href="#finding-hx" class="table-of-contents__link">Finding H(x)</a></li><li><a href="#finding-hx2-1" class="table-of-contents__link">Finding H(x<sub>2</sub>)<sup>-1</sup></a></li><li><a href="#putting-it-all-together" class="table-of-contents__link">Putting it all together</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/where-do-i-start">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Contrast</div><ul class="footer__items"><li class="footer__item"><a href="https://www.contrastsecurity.com/careers" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Careers<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/contrastsec" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.contrastsecurity.com/privacy-matters" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Privacy Matters<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.contrastsecurity.com/enduser-terms-0317a" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Terms of Service<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">DevSec Blog</a></li><li class="footer__item"><a href="https://github.com/Contrast-Security-OSS" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Contrast Security.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.0182176c.js"></script>
<script src="/assets/js/main.42a8bce7.js"></script>
</body>
</html>